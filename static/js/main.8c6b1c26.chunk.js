(this["webpackJsonpblog-manager"]=this["webpackJsonpblog-manager"]||[]).push([[0],{136:function(e,t,n){},140:function(e,t){},142:function(e,t){},156:function(e,t){},158:function(e,t){},186:function(e,t){},188:function(e,t){},189:function(e,t){},194:function(e,t){},196:function(e,t){},215:function(e,t){},227:function(e,t){},230:function(e,t){},251:function(e,t,n){},252:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n(2),c=n.n(s),a=n(128),r=n.n(a),i=n(18),l=n(9),u=n(5),h=(n(136),n(129)),d=n.n(h),b=function(e){var t=Object(u.f)();return Object(o.jsx)("div",{className:"userFormContainer",children:Object(o.jsxs)("div",{className:"userForm",children:[Object(o.jsx)("h3",{children:"Log in"}),Object(o.jsxs)("form",{children:[Object(o.jsxs)("label",{children:[" Username:",Object(o.jsx)("input",{type:"text",name:"username",value:e.username,onChange:e.onChange})]}),Object(o.jsxs)("label",{children:[" Password:",Object(o.jsx)("input",{type:"password",name:"password",value:e.password,onChange:e.onChange})]}),Object(o.jsxs)("p",{children:["Don't have an account? ",Object(o.jsx)(l.b,{to:"/signup",children:"Sign Up"})]}),Object(o.jsx)("button",{type:"submit",onClick:function(n){n.preventDefault(),fetch("".concat("https://odin-blogapi.herokuapp.com","/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e.username,password:e.password})}).then((function(e){return e.json()})).then((function(e){console.log(e),200===e.status&&(localStorage.setItem("authToken",e.token),localStorage.setItem("currentUser",JSON.stringify(e.user)),t.push("/"))}))},children:"Log In"})]})]})})},j=function(e){var t=Object(u.f)();function n(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}if(Object(s.useEffect)((function(){e.setTitle(""),e.setContent(""),e.setPublished(!1),e.setEditAuthor(""),fetch("".concat("https://odin-blogapi.herokuapp.com","/posts")).then((function(e){return e.json()})).then((function(t){if(console.log(t),localStorage.getItem("currentUser")){var n=JSON.parse(localStorage.getItem("currentUser")).username,o=t.post_list.filter((function(e){return e.author&&e.author.username===n}));e.setUserPosts(o)}})).catch((function(e){return console.error(e)}))}),[]),e.userPosts)var c=e.userPosts.map((function(e){return Object(o.jsxs)("div",{className:e.published?"preview":"preview unpublishedPost","data-post":JSON.stringify(e),"data-id":e._id,children:[Object(o.jsxs)("h2",{className:"postTitle",children:[e.title,Object(o.jsx)("span",{children:e.published?"":" (Unpublished)"})]}),Object(o.jsxs)("div",{className:"actions",children:[Object(o.jsx)("button",{className:e.published?"unpublish":"publish",onClick:a,children:e.published?"Unpublish":"Publish"}),Object(o.jsx)("button",{className:"delete",onClick:r,children:"Delete"}),Object(o.jsx)("button",{className:"edit",onClick:i,children:"Edit"})]}),Object(o.jsx)("div",{className:"content",dangerouslySetInnerHTML:{__html:n(e.content)}})]},e._id)}));function a(e){var t=e.target.parentElement.parentElement,o=JSON.parse(t.getAttribute("data-post"));fetch("".concat("https://odin-blogapi.herokuapp.com","/posts/").concat(o.id),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("authToken")},body:JSON.stringify({title:o.title,content:n(o.content),published:!o.published,author:o.author._id})}).then((function(e){return e.json()})).then((function(e){console.log(e),window.location.reload()})).catch((function(e){return console.error(e)}))}function r(e){var t=e.target.parentElement.parentElement.getAttribute("data-id");fetch("".concat("https://odin-blogapi.herokuapp.com","/posts/").concat(t),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("authToken")}}).then((function(e){return e.json()})).then((function(e){console.log(e),window.location.reload()})).catch((function(e){return console.error(e)}))}function i(n){var o=n.target.parentElement.parentElement,s=JSON.parse(o.getAttribute("data-post"));console.log(s),e.setTitle(s.title),e.setContent(s.content),e.setPublished(s.published),e.setEditAuthor(s.author._id),t.push("/posts/"+s.id)}return e.checkExpiration(),localStorage.getItem("currentUser")?Object(o.jsxs)("div",{className:"homepage",children:[Object(o.jsxs)("h1",{children:["Blog Posts by ",JSON.parse(localStorage.getItem("currentUser")).username]}),Object(o.jsx)(l.b,{to:"/posts",children:Object(o.jsx)("div",{className:"createPost",children:Object(o.jsx)("h2",{children:"Create a new Post"})})}),c]}):(t.push("/login"),Object(o.jsxs)("div",{children:[Object(o.jsx)(l.b,{to:"/login",children:"Login"}),"Welcome guest"]}))},p=n(42),g=function(e){var t=Object(u.f)();return Object(o.jsxs)("div",{className:"postForm",children:[Object(o.jsx)("h2",{children:"Creating New Post"}),Object(o.jsxs)("form",{children:[Object(o.jsxs)("label",{children:["Title",Object(o.jsx)("input",{type:"text",name:"title",className:"formTitle",value:e.title,onChange:e.onChange})]}),Object(o.jsxs)("label",{children:[" Post Content",Object(o.jsx)(p.a,{className:"editor",textareaName:"myTextArea",apiKey:"iou7093g4pl6zn5mrc6fxwye33asheqmzogqvbiyn985qfef",value:e.content,onEditorChange:e.onChange,tagName:"textarea",init:{height:300,menubar:!1,plugins:["advlist autolink lists link image","charmap print preview anchor help","searchreplace visualblocks code","insertdatetime media table paste wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | help"}})]}),Object(o.jsxs)("label",{children:["Publish",Object(o.jsx)("input",{type:"checkbox",name:"published",value:e.published,checked:e.published,onChange:e.onChange})]}),Object(o.jsx)("button",{onClick:function(n){n.preventDefault(),e.checkExpiration(),localStorage.getItem("authToken")?fetch("".concat("https://odin-blogapi.herokuapp.com","/posts"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("authToken")},body:JSON.stringify({title:e.title,content:e.content,published:e.published})}).then((function(e){return e.json()})).then((function(e){console.log(e),t.push("/")})).catch((function(e){return console.error(e)})):t.push("./login")},type:"submit",children:"Submit"})]})]})},m=function(e){var t,n=Object(u.g)().id,s=Object(u.f)();return Object(o.jsxs)("div",{className:"postForm",children:[Object(o.jsxs)("h2",{children:["Editing ",e.title]}),Object(o.jsxs)("form",{children:[Object(o.jsx)("div",{className:"return",onClick:function(){return s.push("/")}}),Object(o.jsxs)("label",{children:["Title",Object(o.jsx)("input",{type:"text",name:"title",className:"formTitle",value:e.title,onChange:e.onChange})]}),Object(o.jsxs)("label",{children:[" Post Content",Object(o.jsx)(p.a,{textareaName:"myTextArea",apiKey:"iou7093g4pl6zn5mrc6fxwye33asheqmzogqvbiyn985qfef",initialValue:(t=e.content,(new DOMParser).parseFromString(t,"text/html").documentElement.textContent),onEditorChange:e.onChange,init:{height:300,menubar:!1,plugins:["advlist autolink lists link image","charmap print preview anchor help","searchreplace visualblocks code","insertdatetime media table paste wordcount"],toolbar:"undo redo | formatselect | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent | help"}})]}),Object(o.jsxs)("label",{children:["Publish?",Object(o.jsx)("input",{type:"checkbox",name:"published",value:e.published,checked:e.published,onChange:e.onChange})]}),Object(o.jsx)("button",{onClick:function(t){t.preventDefault(),e.checkExpiration(),localStorage.getItem("authToken")?fetch("".concat("https://odin-blogapi.herokuapp.com","/posts/").concat(n),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("authToken")},body:JSON.stringify({title:e.title,content:e.content,published:e.published,author:e.editAuthor})}).then((function(e){return e.json()})).then((function(e){console.log(e),s.push("/")})).catch((function(e){return console.error(e)})):s.push("./login")},type:"submit",children:"Submit"})]})]})},O=function(e){return localStorage.getItem("currentUser")?Object(o.jsxs)("header",{children:[Object(o.jsx)(l.b,{to:"/",children:"Blog Manager"}),Object(o.jsxs)("nav",{children:[Object(o.jsx)("a",{href:"https://lufere.dev/blog-API",children:"Blog Viewer"}),Object(o.jsxs)("p",{children:["Welcome ",Object(o.jsx)("span",{children:JSON.parse(localStorage.getItem("currentUser")).username})]}),Object(o.jsx)("button",{onClick:function(){localStorage.clear(),window.location.reload()},children:"Logout"})]})]}):Object(o.jsxs)("header",{children:[Object(o.jsx)(l.b,{to:"/",children:"Blog Manager"}),Object(o.jsxs)("nav",{children:[Object(o.jsx)("a",{href:"https://lufere.dev/blog-API",children:"Blog Viewer"}),Object(o.jsx)(l.b,{to:"/login",children:"Login"}),Object(o.jsx)(l.b,{to:"/signup",children:"Sign up"})]})]})},f=function(e){var t=Object(u.f)();return Object(o.jsx)("div",{className:"userFormContainer",children:Object(o.jsxs)("div",{className:"userForm",children:[Object(o.jsx)("h3",{children:"Sign up"}),Object(o.jsxs)("form",{children:[Object(o.jsxs)("label",{children:[" Username",Object(o.jsx)("input",{type:"text",name:"username",value:e.username,onChange:e.onChange})]}),Object(o.jsxs)("label",{children:[" Password",Object(o.jsx)("input",{type:"password",name:"password",value:e.password,onChange:e.onChange})]}),Object(o.jsxs)("p",{children:["Already have an account? ",Object(o.jsx)(l.b,{to:"/login",children:" Log In"})]}),Object(o.jsx)("button",{className:"signupSubmit",type:"submit",onClick:function(n){n.preventDefault(),fetch("".concat("https://odin-blogapi.herokuapp.com","/sign-up"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e.username,password:e.password,creator:!0})}).then((function(e){return e.json()})).then((function(n){if(400===n.status&&(console.log("info",n.errors),n.info&&n.info.message&&alert(n.info.message),n.errors&&n.errors.forEach((function(e){return alert(e.msg)})),e.setPassword("")),200===n.status){var o=n.token,s=n.user;console.log("user",n.user),localStorage.setItem("currentUser",JSON.stringify(s)),localStorage.setItem("authToken",o),e.setUsername(""),e.setPassword(""),t.push("/")}})).catch((function(e){return console.error(e)}))},children:"Sign up"})]})]})})};var x=function(){var e=Object(s.useState)(""),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(s.useState)(""),r=Object(i.a)(a,2),h=r[0],p=r[1],x=Object(s.useState)(),v=Object(i.a)(x,2),S=v[0],C=v[1],k=Object(s.useState)(""),y=Object(i.a)(k,2),w=y[0],N=y[1],T=Object(s.useState)(""),P=Object(i.a)(T,2),E=P[0],I=P[1],U=Object(s.useState)(!0),A=Object(i.a)(U,2),J=A[0],B=A[1],D=Object(s.useState)(),z=Object(i.a)(D,2),F=z[0],L=z[1],_=Object(s.useState)(),q=Object(i.a)(_,2),M=q[0],V=q[1];function K(e){var t,n;e.target?(t=e.target.name,n=e.target.value):(t="content",n=e),"username"===t&&c(n),"password"===t&&p(n),"title"===t&&N(n),"content"===t&&I(n),"published"===t&&B(!J)}function W(){if(localStorage.getItem("authToken")){var e=!1,t=localStorage.getItem("authToken"),n=d.a.decode(t,{complete:!0}),o=new Date;n.payload.exp<o.getTime()/1e3&&(e=!0),e&&localStorage.clear()}}return Object(s.useEffect)((function(){W()}),[]),Object(s.useEffect)((function(){return console.log("USER POSTS",F)}),[F]),Object(o.jsxs)(l.a,{children:[Object(o.jsx)(O,{checkExpiration:W}),Object(o.jsxs)(u.c,{children:[Object(o.jsx)(u.a,{exact:!0,path:"/",children:Object(o.jsx)(j,{currentUser:S,setCurrentUser:C,checkExpiration:W,userPosts:F,setUserPosts:L,title:w,setTitle:N,content:E,setContent:I,published:J,setPublished:B,setEditAuthor:V})}),Object(o.jsx)(u.a,{exact:!0,path:"/login",children:Object(o.jsx)(b,{username:n,password:h,onChange:K,currentUser:S,setCurrentUser:C})}),Object(o.jsx)(u.a,{exact:!0,path:"/signup",children:Object(o.jsx)(f,{username:n,setUsername:c,password:h,setPassword:p,onChange:K})}),Object(o.jsx)(u.a,{exact:!0,path:"/posts/",children:Object(o.jsx)(g,{title:w,setTitle:N,content:E,setContent:I,published:J,setPublished:B,onChange:K,checkExpiration:W})}),Object(o.jsx)(u.a,{exact:!0,path:"/posts/:id",children:Object(o.jsx)(m,{title:w,setTitle:N,content:E,setContent:I,published:J,setPublished:B,onChange:K,checkExpiration:W,editAuthor:M,setEditAuthor:V})})]})]})};n(251);r.a.render(Object(o.jsx)(c.a.StrictMode,{children:Object(o.jsx)(x,{})}),document.getElementById("root"))}},[[252,1,2]]]);
//# sourceMappingURL=main.8c6b1c26.chunk.js.map